#!/bin/bash

# ูุณุฎู ููุฑุฏ ูุธุฑ
VERSION="v22.2.0"
NODE_DIR="node-$VERSION-linux-x64"
KEYRING="nodejs-keyring.kbx"

echo "๐ ูุตุจ ุงูู Node.js ูุณุฎู $VERSION"

# ูุฑุญูู 1: ุฏุงูููุฏ ูุงูโูุง
echo "๐ฅ ุฏุงูููุฏ ูุงูโูุง Node.js ู ุงูุถุง..."
curl -O https://nodejs.org/dist/$VERSION/$NODE_DIR.tar.xz
curl -O https://nodejs.org/dist/$VERSION/SHASUMS256.txt.asc

# ูุฑุญูู 2: ุฏุฑุงูุช keyring ุฑุณู
echo "๐ ุฏุฑุงูุช keyring ุฑุณู Node.js..."
curl -fsLo "$KEYRING" "https://github.com/nodejs/release-keys/raw/HEAD/gpg/pubring.kbx"

# ูุฑุญูู 3: ุชุฃุฏ ุงูุถุง
echo "๐งพ ุจุฑุฑุณ ุงูุถุง ุฏุฌุชุงู..."
gpgv --keyring="./$KEYRING" --output SHASUMS256.txt < SHASUMS256.txt.asc

# ูุฑุญูู 4: ุจุฑุฑุณ ูุด ูุงู
echo "๐ ุจุฑุฑุณ ุตุญุช ูุงู ุฏุงูููุฏุดุฏู..."
shasum --check SHASUMS256.txt --ignore-missing

# ูุฑุญูู 5: ูุตุจ Node.js
echo "๐ฆ ูุตุจ Node.js ุฏุฑ ูุณุฑ /opt/nodejs..."
sudo tar -xf $NODE_DIR.tar.xz -C /opt
sudo ln -sf /opt/$NODE_DIR/bin/node /usr/local/bin/node
sudo ln -sf /opt/$NODE_DIR/bin/npm /usr/local/bin/npm

# ูุฑุญูู 6: ุจุฑุฑุณ ููุง
echo "โ ูุณุฎู ูุตุจโุดุฏู:"
node -v
npm -v

echo "๐ ูุตุจ ุงูู Node.js ุจุง ููููุช ุงูุฌุงู ุดุฏ!"
